<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="/css/adminCenter/amazeui.min.css" />
		<link rel="stylesheet" href="/css/adminCenter/admin.css" />
		<link rel="stylesheet" href="">

	</head>
	<script src="/libs/jquery/jquery-3.3.1.min.js"></script>
	<script src="/js/adminCenter/mods/index.js"></script>
	<script src="/js/amazeui.min.js"></script>

	<script th:inline="javascript">
		$(function () {
			$.ajax({
						url: "/attracMgr/getAttracType",
						type: "get",
						data: null,
						//async:false,
						success: function (data) {
							console.log(data)
							$("#qtype").prepend("<option value=''>请选择景点类型</option>");
							for (var i = 0; i < data.data.length; i++) {

								$("#qtype").append
								("<option value='" + data.data[i].attracTypeId + "'>" + data.data[i].attracTypeName + "</option>");
							}
						}
					}
			);


			$.ajax({
						url: "/attracMgr/getCity",
						type: "get",
						data: null,
						//async:false,
						success: function (data) {
							console.log(data)
							$("#qcity").prepend("<option value=''>请选择城市</option>");
							for (var i = 0; i < data.data.length; i++) {

								$("#qcity").append
								("<option value='" + data.data[i].cityId + "'>" + data.data[i].cityName+'/'+data.data[i].cityEngName + "</option>");
							}
						}
					}
			);

			//初始加载全部数据
			initResult()

			$("#subBtn").click(function () {

				var qData={
					"queryAttracName":$("#qname").val(),
					"queryAttracCity":$("#qcity").val(),
					"queryAttracAdd":$("#qadd").val(),
					"queryAttracType":$("#qtype").val()
				};

				$.ajax({
					url : "/attracMgr/loadAllAttractionsJ",
					type : "post",
					async : true,

					data : qData,
					dataType : 'json',
					success : function(data) {
						console.log(data)
						$("#tableresult").html(" ")
						var str="";
						for(var i=0;i<data.length; i++){
							str += "<tr>" +
									"<td align='center'>" + data[i].attracId + "</td>" +
									"<td align='center'>" + data[i].attracName + "</td>" +
									"<td align='center'>" + data[i].attracCity.cityName + "</td>" +
									"<td align='center'>" + data[i].attracNoteCount + "</td>" +
									"<td align='center'>" + data[i].attracGuideCount + "</td>" +
									"<td align='center'>" + data[i].attracType.attracTypeName + "</td>" +
									"<td align='center'><a class='am-btn am-btn-success' href='/attracMgr/attractionDetail/"+data[i].attracId+"'> 详细信息</a></td>" +
									"<td align='center'><a class='am-btn am-btn-primary' href='/attracMgr/updateAttraction/"+data[i].attracId+"'> 更新数据</a></td>"+
									"</tr>";
						}
						$("#tableresult").html(str)
					}
				});
			})
		});


		function initResult() {
			var initData={
				"queryAttracName":"",
				"queryAttracCity":"",
				"queryAttracAdd":"",
				"queryAttracType":""
			};

			$.ajax({
				url : "/attracMgr/loadAllAttractionsJ",
				type : "post",
				async : true,

				data : initData,
				dataType : 'json',
				success : function(data) {
					console.log(data)
					var str="";
					for(var i=0;i<data.length; i++){
						str += "<tr>" +
								"<td align='center'>" + data[i].attracId + "</td>" +
								"<td align='center'>" + data[i].attracName + "</td>" +
								"<td align='center'>" + data[i].attracCity.cityName + "</td>" +
								"<td align='center'>" + data[i].attracNoteCount + "</td>" +
								"<td align='center'>" + data[i].attracGuideCount + "</td>" +
								"<td align='center'>" + data[i].attracType.attracTypeName + "</td>" +
								"<td align='center'><a class='am-btn am-btn-success' href='/attracMgr/attractionDetail/"+data[i].attracId+"'> 详细信息</a></td>" +
								"<td align='center'><a class='am-btn am-btn-primary' href='/attracMgr/updateAttraction/"+data[i].attracId+"'> 更新数据</a></td>"+
								"</tr>";
					}
					$("#tableresult").html(str)
				}
			});
		}
	</script>
	</head>

	<body>
		<div class="admin-content-body">
			<div class="am-cf am-padding am-padding-bottom-0">
				<div class="am-fl am-cf"><strong class="am-text-primary am-text-lg">景点管理</strong><small></small></div>
			</div>

			<hr>

			<f class="am-g">
				<div class="am-u-sm-12 am-u-md-6">
					<div class="am-btn-toolbar">
						<div class="am-btn-group am-btn-group-xs">
							<a href="/attracMgr/createAttrac" class="am-btn am-btn-default"><span class="am-icon-plus"></span> 新增</a>
						</div>
					</div>
				</div>
				<div class="am-u-sm-12 am-u-md-3">

				</div>
				<form class="am-form-inline" role="form" onsubmit="return false" action="##" method="post">
					<div class="am-form-group">
						<input type="text" id="qname" class="am-form-field" placeholder="请输入景点名称" >
					</div>

					<div class="am-form-group">
						<select id="qcity" class="am-form-field" >

						</select>
						<span class="am-form-caret"></span>
					</div>
					<div class="am-form-group">
						<input type="text"  id="qadd" class="am-form-field" placeholder="请输入具体地址" >
					</div>
					<div class="am-form-group">
						<select id="qtype"  class="am-form-field">

						</select>
					</div>

            				<button id="subBtn" class="am-btn am-btn-default" type="button">搜索</button>





				</form>
			<div class="am-g">
				<div class="am-u-sm-12">
					<form class="am-form">
						<table class="am-table am-table-striped am-table-hover table-main">
							<thead>
								<tr>
									<th class="table-id">ID</th>
									<th class="table-type">景点名</th>
									<th class="table-type">所在城市</th>
									<th class="table-type">游记数</th>
									<th class="table-type">指南数</th>
									<th class="table-type">景点类型</th>
									<th class="table-type"></th>
									<th class="table-set">操作</th>
									<th class="table-type"></th>
								</tr>
							</thead>
							<tbody id="tableresult">

							</tbody>
						</table>


						<hr>
					</form>
				</div>
			</div>
		</div>
	</body>
</html>